2021-08-23 07:59:14,326 INFO  org.apache.flume.sink.AvroSink.start(AvroSink.java:193) Avro sink starting
2021-08-23 07:59:14,333 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:14,347 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:14,347 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:14,356 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x314c508a] OPEN
2021-08-23 07:59:14,361 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x5ab7b5f1, /127.0.0.1:40958 => /127.0.0.1:41414] OPEN
2021-08-23 07:59:14,364 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x5ab7b5f1, /127.0.0.1:40958 => /127.0.0.1:41414] BOUND: /127.0.0.1:41414
2021-08-23 07:59:14,364 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x314c508a, /127.0.0.1:40958 => localhost/127.0.0.1:41414] BOUND: /127.0.0.1:40958
2021-08-23 07:59:14,364 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x5ab7b5f1, /127.0.0.1:40958 => /127.0.0.1:41414] CONNECTED: /127.0.0.1:40958
2021-08-23 07:59:14,364 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x314c508a, /127.0.0.1:40958 => localhost/127.0.0.1:41414] CONNECTED: localhost/127.0.0.1:41414
2021-08-23 07:59:14,371 DEBUG org.apache.flume.sink.AvroSink.start(AvroSink.java:208) Avro sink started
2021-08-23 07:59:14,371 DEBUG org.apache.flume.lifecycle.LifecycleController.waitForOneOf(LifecycleController.java:56) Waiting for state [START, ERROR] for delegate:org.apache.flume.sink.AvroSink@1dd92fe2 up to 5000ms
2021-08-23 07:59:14,874 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x5ab7b5f1, /127.0.0.1:40958 :> /127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:14,874 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x5ab7b5f1, /127.0.0.1:40958 :> /127.0.0.1:41414] UNBOUND
2021-08-23 07:59:14,875 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x5ab7b5f1, /127.0.0.1:40958 :> /127.0.0.1:41414] CLOSED
2021-08-23 07:59:14,877 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x314c508a, /127.0.0.1:40958 :> localhost/127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:14,880 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x314c508a, /127.0.0.1:40958 :> localhost/127.0.0.1:41414] UNBOUND
2021-08-23 07:59:14,880 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x314c508a, /127.0.0.1:40958 :> localhost/127.0.0.1:41414] CLOSED
2021-08-23 07:59:14,881 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:14,881 DEBUG org.apache.avro.ipc.NettyTransceiver.disconnect(NettyTransceiver.java:293) Disconnecting from localhost/127.0.0.1:41414
2021-08-23 07:59:15,387 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:15,388 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5ea434c8] OPEN
2021-08-23 07:59:15,389 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5ea434c8] CLOSED
2021-08-23 07:59:15,389 ERROR org.apache.flume.api.NettyAvroRpcClient.appendBatch(NettyAvroRpcClient.java:220) RPC request IO exception. 
java.io.IOException: Error connecting to localhost/127.0.0.1:41414
	at org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:249)
	at org.apache.avro.ipc.NettyTransceiver.getRemoteName(NettyTransceiver.java:364)
	at org.apache.avro.ipc.Requestor.writeHandshake(Requestor.java:202)
	at org.apache.avro.ipc.Requestor.access$300(Requestor.java:52)
	at org.apache.avro.ipc.Requestor$Request.getBytes(Requestor.java:478)
	at org.apache.avro.ipc.Requestor.request(Requestor.java:147)
	at org.apache.avro.ipc.Requestor.request(Requestor.java:129)
	at org.apache.avro.ipc.specific.SpecificRequestor.invoke(SpecificRequestor.java:68)
	at com.sun.proxy.$Proxy4.appendBatch(Unknown Source)
	at org.apache.flume.api.NettyAvroRpcClient.appendBatch(NettyAvroRpcClient.java:218)
	at org.apache.flume.api.NettyAvroRpcClient.appendBatch(NettyAvroRpcClient.java:186)
	at org.apache.flume.sink.AvroSink.process(AvroSink.java:250)
	at org.apache.flume.sink.TestAvroSink.testFailedConnect(TestAvroSink.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:715)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.connect(NioClientSocketPipelineSink.java:401)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.processSelectedKeys(NioClientSocketPipelineSink.java:370)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.run(NioClientSocketPipelineSink.java:292)
	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)
	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2021-08-23 07:59:15,389 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:15,392 DEBUG org.apache.flume.sink.AvroSink.destroyConnection(AvroSink.java:155) Closing avro client:org.apache.flume.api.NettyAvroRpcClient@534df152
2021-08-23 07:59:15,394 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:15,398 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:15,399 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:15,399 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x52e677af] OPEN
2021-08-23 07:59:15,400 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x52e677af] CLOSED
2021-08-23 07:59:15,400 ERROR org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:129) RPC connection error :
java.io.IOException: Error connecting to localhost/127.0.0.1:41414
	at org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:249)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:198)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:147)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:124)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:107)
	at org.apache.flume.api.NettyAvroRpcClient.<init>(NettyAvroRpcClient.java:92)
	at org.apache.flume.api.RpcClientFactory.getDefaultInstance(RpcClientFactory.java:132)
	at org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:148)
	at org.apache.flume.sink.AvroSink.verifyConnection(AvroSink.java:176)
	at org.apache.flume.sink.AvroSink.process(AvroSink.java:231)
	at org.apache.flume.sink.TestAvroSink.testFailedConnect(TestAvroSink.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:715)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.connect(NioClientSocketPipelineSink.java:401)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.processSelectedKeys(NioClientSocketPipelineSink.java:370)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.run(NioClientSocketPipelineSink.java:292)
	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)
	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2021-08-23 07:59:15,400 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:15,402 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:15,406 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:15,406 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:15,407 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x55a1c291] OPEN
2021-08-23 07:59:15,408 ERROR org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:129) RPC connection error :
java.io.IOException: Error connecting to localhost/127.0.0.1:41414
	at org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:249)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:198)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:147)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:124)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:107)
	at org.apache.flume.api.NettyAvroRpcClient.<init>(NettyAvroRpcClient.java:92)
	at org.apache.flume.api.RpcClientFactory.getDefaultInstance(RpcClientFactory.java:132)
	at org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:148)
	at org.apache.flume.sink.AvroSink.verifyConnection(AvroSink.java:176)
	at org.apache.flume.sink.AvroSink.process(AvroSink.java:231)
	at org.apache.flume.sink.TestAvroSink.testFailedConnect(TestAvroSink.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:715)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.connect(NioClientSocketPipelineSink.java:401)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.processSelectedKeys(NioClientSocketPipelineSink.java:370)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.run(NioClientSocketPipelineSink.java:292)
	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)
	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2021-08-23 07:59:15,408 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x55a1c291] CLOSED
2021-08-23 07:59:15,409 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:15,409 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:15,413 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:15,413 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:15,414 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x1b083826] OPEN
2021-08-23 07:59:15,414 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x1b083826] CLOSED
2021-08-23 07:59:15,415 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:15,414 ERROR org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:129) RPC connection error :
java.io.IOException: Error connecting to localhost/127.0.0.1:41414
	at org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:249)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:198)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:147)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:124)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:107)
	at org.apache.flume.api.NettyAvroRpcClient.<init>(NettyAvroRpcClient.java:92)
	at org.apache.flume.api.RpcClientFactory.getDefaultInstance(RpcClientFactory.java:132)
	at org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:148)
	at org.apache.flume.sink.AvroSink.verifyConnection(AvroSink.java:176)
	at org.apache.flume.sink.AvroSink.process(AvroSink.java:231)
	at org.apache.flume.sink.TestAvroSink.testFailedConnect(TestAvroSink.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:715)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.connect(NioClientSocketPipelineSink.java:401)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.processSelectedKeys(NioClientSocketPipelineSink.java:370)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.run(NioClientSocketPipelineSink.java:292)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2021-08-23 07:59:15,416 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:15,419 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:15,419 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:15,420 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x123f1134] OPEN
2021-08-23 07:59:15,421 ERROR org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:129) RPC connection error :
java.io.IOException: Error connecting to localhost/127.0.0.1:41414
	at org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:249)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:198)
	at org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:147)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:124)
	at org.apache.flume.api.NettyAvroRpcClient.connect(NettyAvroRpcClient.java:107)
	at org.apache.flume.api.NettyAvroRpcClient.<init>(NettyAvroRpcClient.java:92)
	at org.apache.flume.api.RpcClientFactory.getDefaultInstance(RpcClientFactory.java:132)
	at org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:148)
	at org.apache.flume.sink.AvroSink.verifyConnection(AvroSink.java:176)
	at org.apache.flume.sink.AvroSink.process(AvroSink.java:231)
	at org.apache.flume.sink.TestAvroSink.testFailedConnect(TestAvroSink.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:715)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.connect(NioClientSocketPipelineSink.java:401)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.processSelectedKeys(NioClientSocketPipelineSink.java:370)
	at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink$Boss.run(NioClientSocketPipelineSink.java:292)
	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)
	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2021-08-23 07:59:15,421 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x123f1134] CLOSED
2021-08-23 07:59:15,422 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:15,425 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:15,429 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:15,429 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:15,429 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5d740a0f] OPEN
2021-08-23 07:59:15,430 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x606d8fe4, /127.0.0.1:41006 => /127.0.0.1:41414] OPEN
2021-08-23 07:59:15,451 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x606d8fe4, /127.0.0.1:41006 => /127.0.0.1:41414] BOUND: /127.0.0.1:41414
2021-08-23 07:59:15,451 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5d740a0f, /127.0.0.1:41006 => localhost/127.0.0.1:41414] BOUND: /127.0.0.1:41006
2021-08-23 07:59:15,451 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x606d8fe4, /127.0.0.1:41006 => /127.0.0.1:41414] CONNECTED: /127.0.0.1:41006
2021-08-23 07:59:15,451 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5d740a0f, /127.0.0.1:41006 => localhost/127.0.0.1:41414] CONNECTED: localhost/127.0.0.1:41414
2021-08-23 07:59:15,483 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:15,487 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:15,489 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:15,491 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:15,493 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:18,494 INFO  org.apache.flume.sink.AvroSink.stop(AvroSink.java:213) Avro sink stopping
2021-08-23 07:59:18,494 DEBUG org.apache.flume.sink.AvroSink.destroyConnection(AvroSink.java:155) Closing avro client:org.apache.flume.api.NettyAvroRpcClient@161b062a
2021-08-23 07:59:18,494 DEBUG org.apache.avro.ipc.NettyTransceiver.disconnect(NettyTransceiver.java:293) Disconnecting from localhost/127.0.0.1:41414
2021-08-23 07:59:18,495 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5d740a0f, /127.0.0.1:41006 :> localhost/127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:18,495 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x606d8fe4, /127.0.0.1:41006 :> /127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:18,495 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5d740a0f, /127.0.0.1:41006 :> localhost/127.0.0.1:41414] UNBOUND
2021-08-23 07:59:18,495 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x606d8fe4, /127.0.0.1:41006 :> /127.0.0.1:41414] UNBOUND
2021-08-23 07:59:18,496 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x5d740a0f, /127.0.0.1:41006 :> localhost/127.0.0.1:41414] CLOSED
2021-08-23 07:59:18,496 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x606d8fe4, /127.0.0.1:41006 :> /127.0.0.1:41414] CLOSED
2021-08-23 07:59:18,496 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:18,497 DEBUG org.apache.flume.sink.AvroSink.stop(AvroSink.java:219) Avro sink stopped. Metrics:{ name:null counters:{batch.success=6, batch.empty=1, batch.underflow=1} }
2021-08-23 07:59:18,497 DEBUG org.apache.flume.lifecycle.LifecycleController.waitForOneOf(LifecycleController.java:56) Waiting for state [STOP, ERROR] for delegate:org.apache.flume.sink.AvroSink@1dd92fe2 up to 5000ms
2021-08-23 07:59:18,504 INFO  org.apache.flume.sink.AvroSink.start(AvroSink.java:193) Avro sink starting
2021-08-23 07:59:18,505 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:18,509 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:18,509 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:18,510 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x358c99f5] OPEN
2021-08-23 07:59:18,510 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x0c75f8bd, /127.0.0.1:41116 => /127.0.0.1:41414] OPEN
2021-08-23 07:59:18,512 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x0c75f8bd, /127.0.0.1:41116 => /127.0.0.1:41414] BOUND: /127.0.0.1:41414
2021-08-23 07:59:18,512 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x358c99f5, /127.0.0.1:41116 => localhost/127.0.0.1:41414] BOUND: /127.0.0.1:41116
2021-08-23 07:59:18,512 DEBUG org.apache.flume.sink.AvroSink.start(AvroSink.java:208) Avro sink started
2021-08-23 07:59:18,512 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x0c75f8bd, /127.0.0.1:41116 => /127.0.0.1:41414] CONNECTED: /127.0.0.1:41116
2021-08-23 07:59:18,513 DEBUG org.apache.flume.lifecycle.LifecycleController.waitForOneOf(LifecycleController.java:56) Waiting for state [START, ERROR] for delegate:org.apache.flume.sink.AvroSink@48524010 up to 5000ms
2021-08-23 07:59:18,513 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x358c99f5, /127.0.0.1:41116 => localhost/127.0.0.1:41414] CONNECTED: localhost/127.0.0.1:41414
2021-08-23 07:59:18,515 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:18,517 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:18,519 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:18,520 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:18,521 DEBUG org.apache.flume.sink.TestAvroSink$MockAvroServer.appendBatch(TestAvroSink.java:132) Received event batch:[{"headers": {}, "body": {"bytes": "test event 1"}}, {"headers": {}, "body": {"bytes": "test event 1"}}]
2021-08-23 07:59:21,522 INFO  org.apache.flume.sink.AvroSink.stop(AvroSink.java:213) Avro sink stopping
2021-08-23 07:59:21,523 DEBUG org.apache.flume.sink.AvroSink.destroyConnection(AvroSink.java:155) Closing avro client:org.apache.flume.api.NettyAvroRpcClient@4b168fa9
2021-08-23 07:59:21,523 DEBUG org.apache.avro.ipc.NettyTransceiver.disconnect(NettyTransceiver.java:293) Disconnecting from localhost/127.0.0.1:41414
2021-08-23 07:59:21,524 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x358c99f5, /127.0.0.1:41116 :> localhost/127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:21,524 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x0c75f8bd, /127.0.0.1:41116 :> /127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:21,524 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x358c99f5, /127.0.0.1:41116 :> localhost/127.0.0.1:41414] UNBOUND
2021-08-23 07:59:21,524 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x0c75f8bd, /127.0.0.1:41116 :> /127.0.0.1:41414] UNBOUND
2021-08-23 07:59:21,525 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x358c99f5, /127.0.0.1:41116 :> localhost/127.0.0.1:41414] CLOSED
2021-08-23 07:59:21,525 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x0c75f8bd, /127.0.0.1:41116 :> /127.0.0.1:41414] CLOSED
2021-08-23 07:59:21,525 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:21,526 DEBUG org.apache.flume.sink.AvroSink.stop(AvroSink.java:219) Avro sink stopped. Metrics:{ name:null counters:{batch.success=6, batch.empty=1, batch.underflow=1} }
2021-08-23 07:59:21,527 DEBUG org.apache.flume.lifecycle.LifecycleController.waitForOneOf(LifecycleController.java:56) Waiting for state [STOP, ERROR] for delegate:org.apache.flume.sink.AvroSink@48524010 up to 5000ms
2021-08-23 07:59:21,533 INFO  org.apache.flume.sink.AvroSink.start(AvroSink.java:193) Avro sink starting
2021-08-23 07:59:21,534 DEBUG org.apache.flume.sink.AvroSink.createConnection(AvroSink.java:144) Building RpcClient with hostname:localhost, port:41414, batchSize:2
2021-08-23 07:59:21,538 DEBUG org.apache.avro.ipc.NettyTransceiver.<init>(NettyTransceiver.java:190) Using Netty bootstrap options: {connectTimeoutMillis=5000, tcpNoDelay=true}
2021-08-23 07:59:21,538 DEBUG org.apache.avro.ipc.NettyTransceiver.getChannel(NettyTransceiver.java:245) Connecting to localhost/127.0.0.1:41414
2021-08-23 07:59:21,538 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x06b419da] OPEN
2021-08-23 07:59:21,539 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x31999019, /127.0.0.1:41228 => /127.0.0.1:41414] OPEN
2021-08-23 07:59:21,540 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x31999019, /127.0.0.1:41228 => /127.0.0.1:41414] BOUND: /127.0.0.1:41414
2021-08-23 07:59:21,541 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x31999019, /127.0.0.1:41228 => /127.0.0.1:41414] CONNECTED: /127.0.0.1:41228
2021-08-23 07:59:21,541 DEBUG org.apache.flume.sink.AvroSink.start(AvroSink.java:208) Avro sink started
2021-08-23 07:59:21,541 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x06b419da, /127.0.0.1:41228 => localhost/127.0.0.1:41414] BOUND: /127.0.0.1:41228
2021-08-23 07:59:21,542 DEBUG org.apache.flume.lifecycle.LifecycleController.waitForOneOf(LifecycleController.java:56) Waiting for state [START, ERROR] for delegate:org.apache.flume.sink.AvroSink@5906ebcb up to 5000ms
2021-08-23 07:59:21,542 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x06b419da, /127.0.0.1:41228 => localhost/127.0.0.1:41414] CONNECTED: localhost/127.0.0.1:41414
2021-08-23 07:59:21,542 INFO  org.apache.flume.sink.AvroSink.stop(AvroSink.java:213) Avro sink stopping
2021-08-23 07:59:21,543 DEBUG org.apache.flume.sink.AvroSink.destroyConnection(AvroSink.java:155) Closing avro client:org.apache.flume.api.NettyAvroRpcClient@258e2e41
2021-08-23 07:59:21,543 DEBUG org.apache.avro.ipc.NettyTransceiver.disconnect(NettyTransceiver.java:293) Disconnecting from localhost/127.0.0.1:41414
2021-08-23 07:59:21,543 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x06b419da, /127.0.0.1:41228 :> localhost/127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:21,544 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x31999019, /127.0.0.1:41228 :> /127.0.0.1:41414] DISCONNECTED
2021-08-23 07:59:21,544 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x06b419da, /127.0.0.1:41228 :> localhost/127.0.0.1:41414] UNBOUND
2021-08-23 07:59:21,544 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x31999019, /127.0.0.1:41228 :> /127.0.0.1:41414] UNBOUND
2021-08-23 07:59:21,545 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:469) [id: 0x06b419da, /127.0.0.1:41228 :> localhost/127.0.0.1:41414] CLOSED
2021-08-23 07:59:21,545 INFO  org.apache.avro.ipc.NettyServer$NettyServerAvroHandler.handleUpstream(NettyServer.java:141) [id: 0x31999019, /127.0.0.1:41228 :> /127.0.0.1:41414] CLOSED
2021-08-23 07:59:21,545 DEBUG org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473) Remote peer localhost/127.0.0.1:41414 closed connection.
2021-08-23 07:59:21,547 DEBUG org.apache.flume.sink.AvroSink.stop(AvroSink.java:219) Avro sink stopped. Metrics:{ name:null counters:{} }
2021-08-23 07:59:21,547 DEBUG org.apache.flume.lifecycle.LifecycleController.waitForOneOf(LifecycleController.java:56) Waiting for state [STOP, ERROR] for delegate:org.apache.flume.sink.AvroSink@5906ebcb up to 5000ms
